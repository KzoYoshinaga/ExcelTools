' 可変オブジェクト

' メンバー ***************************
Private tuples As New Tuple

' イニシャライザ *********************
' タプルセット
Public Property Let setTuples(ts As Tuple)
    Set tuples = ts
End Property

' クエリ *****************************

' データインポート
' @param s: Worksheet インポートするテーブルが格納されたシート
Public Property Get import(s As Worksheet)
    Dim f As New Factory
    Dim sh As sheet
    Set sh = f.newSheet(s)
    Dim c As New collection
    Dim i As Long
    For i = 1 To sh.getRowCount()
        c.add f.newTuple(sh.getRowCollection(i))
    Next
    Set tuples = f.newTuple(c)
End Property

' データエクスポート
' @param r: Range エクスポートするテーブルを配置するセル
Public Property Get export(r As Range)
    Dim i As Long
    Dim j As Long
    Dim t As Tuple
    For i = 1 To tuples.count()
        Set t = tuples.getValue(i)
        For j = 1 To t.count()
            r.Offset(i - 1, j - 1).value = t.getValue(j).getValue
        Next
    Next
End Function

' 行分割
Public Property Get splitColumn(columnNo As Integer)

End Property

' 列分割
Public Property Get splitRow(rowNo As Integer)

End Property

' 行交互マージ
Public Property Get zip(that As table) As table
    Dim count As Long
    count = less(getRowCount(), that.getRowCount())
    Dim f As New Factory
    Dim c As New collection
    Dim i As Long
    For i = 1 To count
        c.add getTuple(i).zip(that.getTuple(i))
    Next
    Set zip = f.newTable(f.newTuple(c))
End Property


' 列交互マージ
Public Property Get pile(that As table) As table
    Dim f As New Factory
    Dim t As Tuple
    Set t = tuples.zip(that.getTuples())
    Set pile = f.newTable(t)
End Property

Public Property Get getTuple(n As Long) As Tuple
    Set getTuple = tuples.getValue(n)
End Property

' タプタプ
Public Property Get getTuples() As Tuple
    Set getTuples = tuples
End Property

Public Property Get getRowCount() As Long
    getRowCount = tuples.count()
End Property
